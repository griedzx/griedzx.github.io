# 生物信息原理复习

## 测序技术

|          | 代表                 | 优点                                                                          | 缺点                                    |
| -------- | -------------------- | ----------------------------------------------------------------------------- | --------------------------------------- |
| 一代测序 | sanger(合成终止测序) | 准确率高<br />读长较长                                                        | 分离速度低<br />成本难以降低            |
| 二代测序 |                      | 较一代测序 降低成本<br />准确率较高<br />测序时间较快                         | 读长短<br />（DNA簇中存在光学信号移项） |
| 三代测序 |                      | 读长较长，减少拼接成本<br />降低内存和计算时间<br />原理长避免pcr扩增引入错误 | 依赖DNA聚合酶活性<br />成本昂贵         |



## 数据库

TrEMBL是自动化翻译获得的蛋白质数据库，不含二级结构信息



## 双序列比对

### 经典算法

* 全局比对 NW算法
* 局部比对 SW算法

gap 矩阵中横向移动则纵向表示的序列新增'-',反之横向新增

### 打分矩阵的构建以及异同

PAM-n中，n 越小，表示氨基酸变异的可能性越小；相似的序列之间比较应该选用n值小的矩阵，不太相似的序列之间比较应该选用n值大的矩阵（PAM-250用于约20%相同序列之间的比较）。

BLOSUM-n中，n越小，表示氨基酸相似的可能性越小；相似的序列之间比较应该选用 n 值大的矩阵，不太相似的序列之间比较应该选用n值小的矩阵（BLOSUM62用于约62%相同序列之间的比较）

* 一致性(identity)：两条序列在同一位点上的核苷酸或者氨基酸残基完全相同
* 同源性(homoogy)：两条序列存在进化方面的关系，它们从一条共同的祖先序列进化而来。同源可以分为直系同源和旁系同源
* 相似性：两条序列在同一位点上的氨基酸残基的化学性质相似。相似性可以用百分比描述，但同源性不可以


若双序列比对中，比对序列过长或者需要进行两两比对的序列多（搜库），还有其他算法

* Blast
* 基因组序列比对
* 短序列比对

### BLAST比对

#### 基本原理

1. 为序列A构建一个k-mer/k-tuple哈希表
2. 扫描序列B，找到hits(比对后得分大于t的片段)
3. 扩展hits(使用SW算法扩展高得分片段对HSPS，这些片段的分值不会因为片段的延申而进一步升高)

### PSSM

### 信息熵

## 序列拼接（基因组装）和短序列比对

### 如何获得全基因组（组装）的序列

* BAC by BAC

### 基因组序列组装的主要步骤

### 二、三代测序数据在组装中的应用和各自优势

主流：

* 三代测序数据搭建contig
* 二代短片段数据纠错
* 利用BioNano/Hi-C等技术将contig连接成scaffold或者染色体水平

三代测序技术中PacBio可以

1. 克服序列中高GC含量或者重复序列多，以精细基因注释
2. 长片段填补二代测序数据组装中的gap以及连接contig成scaffold

### 基于三代长片段测序数据的从头组装流程


### 组装质量评估

3c原则

1. 组装连续性 contiguity
   * N50/N90 数值越大，组装效果越好
   * L50/L90 数值越小，组装效果越好
2. 组装完整度 completeness
   * 读段回帖  组装读段重新比对会基因组，理论上能比对上的读段的比例越高，则组装完整性越好效果越好
   * LAI
   * BUSCO CEGMA   将某些物种共有的保守基因，比对到或通过其它方法检索基因组，根据能检索出的基因数量
   * K-mer 通过比较用于组装的测序读段含有的Kmer集合，与组装好的序列含有的Kmer集合，评估基因组组装的完整性
3. 组装准确率 correctness
   * 读段回帖
   * K-mer


### 短序列比对

#### BWT

##### 编码

![1705583346654](image/index/1705583346654.png)

对L列进行从小到大排序得到F列

##### 解码

![1705583325162](image/index/1705583325162.png)

## 隐马科夫模型（HMM）和基因组注释

学习问题：向前向后算法（EM）

原核生物和真核生物基因组的特点及异同

对基因预测影响

## 基因定位和全基因组关联分析

QTL,数量性状:在一个群体内表现为连续变异的形状，相对性状间没有质的差异

分子标记：以个体间遗传物质的核苷酸序列变异为基础的遗传标记，优点在于不变，稳定可靠以及数量丰富

* southern杂交
* PCR扩增
* 单核苷酸多态性

### QTL

代表染色体上影响数量性状的某个区段，区段内可能有一个甚至多个影响数量性状的功能基因

#### QTL定位原理

当标记和控制特定性状基因连锁时，不同标记基因型的表型值存在显著差异，通过表型与标记间关联分析，来确定控制数量性状的基因在染色体上的位置和效应

    目的：定位影响数量性状的功能基因

#### QTL基本步骤

1. 分离世代群体建立
2. 遗传标记检测和表型测定
3. QTL统计分析
   1. 单标记分析
   2. 区间作图法
   3. 复合区间作图法
4. 候选基因鉴定

#### LOD值与阈值确定

##### LOD

log10(L1/L0)，L1是该位点有QTL的概率，L0是该位点无QTL的概率。如果LOD=2，则意味着这个位点有QTL的概率是无QTL的概率的10^2倍。

#### LOD置信区间

QTL定位的结果是1个LOD值在染色体上变化的波形图，QTL区域的LOD值会形成一个信号峰，功能基因通常是位于这个区间内

    为了便于后续研究中筛选候选基因，我们通常会设置一个范围筛选候选基因。一般经验值会使用2-LOD置信区间

2-LOD置信区间就是LOD波动曲线从峰的最大值降低2的时候(Y轴), 对应在遗传图谱上跨越的区域(X轴)。2-LOD置信区间大概对应99.8%的置信区间，即功能基因有99.8%概率已经落在这个区域内了

#### 显著性阈值的确定

### Permutation test

无放回的数据重复抽样方法

![1705562660054](image/index/1705562660054.png)

不做permutation test时可以用人为给定的阈值：LOD > 2-3

### GWAS

#### 原理

SNP与表型的相关联，如果SNP与表现型两个维度协同变化，就可以推测这个SNP位点极有可能与表型相关

#### 优点

1. **标记密度高**，理论上可获得群体中所有的变异，并能利用历史上的重组，因而具有较高的定位精度
2. **具有丰富的变异**，与人工构建的群体变异来源两个或少数几个亲本相比，自然群体中的变异来自于几百上千乃至数十万的个体
3. **快速简便**，无需构建群体耗时

### 缺点

1. 标记数目多，运算量较大
2. 较复杂的遗传背景，造成较高的假阳性和假阴性
3. 不同频率的变异检出效率不同，只能检出常见变异

#### 群体结构

由于个体之间非随机交配而导致的群体中亚群之间等位基因频率的系统差异。即：存在大量物理位置上离得远的LD位点

影响：由于等位基因频率在亚群中可能不同，因此群体分层可能导致假阳性关联，会降低克隆基因定位的精度

#### 混合线性模型

在方差分析模型中既包括固定效应，还包括随机效应的模型

GWAS使用混合线性模型：

一般的简单线性模型只能分析表型受某一基因影响，但实际上大多数表型都受到许多不同的基因影响。

* 混合线性模型添加了**随机效应**以校正遗传背景，能判断表型受多个基因影响，更符合多基因假说。
* 混合线性模型通过**校正群体结构和群体内复杂的亲缘关系**来分析标记和表型的相关性，有效控制人口结构和近交效应的影响

#### 亲缘关系矩阵（Kinship）

量化群体结构的矩阵，用来校正群体内复杂的亲缘关系

(1)控制人口结构和近交效应

(2)估计随机效应

(3)处理缺失数据

#### LD 连锁不平衡

群体中不同位点的等位基因间的非随机关联现象

    连锁是指位于同一染色体上的基因具有一起遗传的倾向（物理上接近）

    连锁不平衡（LD）是指分属两个或两个以上基因座位的等位基因同时出现的几率，高于随机出现的频率

    LD（不一定物理上接近，不同染色体上的位点由于遗传漂变等可产生连锁不平衡）


#### 曼哈顿图 & QQ-plot

曼哈顿图

GWAS分析之后的所有SNP位点的p-value在整个基因组上展示出来，一般Y轴使用-log10(p-value)，Y轴的高度就对应了表型和位点的关联程度。Y轴值越大，p-value越小，位点和表型的关联程度越大。

qq-plot

评估GWAS结果中的关联统计量是否偏离了预期的分布

因为可能存在自然选择和遗传漂变导致基因位点突变。如果不存在突变情况，则p-value的分布和均匀分布结果应该集中在同一条直线上；如果存在突变，那么当p-value越小时两种概率分布的分离程度越高，QQ图会翘起来。


### 缺失基因型填补

基因型缺失一般分为两种，

* 遗传性缺失：个体遗传信息的变异（例如，位点DNA片段真实缺失）导致的基因型缺失，
* 检测性缺失：由于检测技术的局限、错误等导致的信息丢失，

基于参考群体已有的基因型，预测目标个体未进行基因分型的位点的基因型


### 决定GWAS和QTL定位精度的因素

**最根本的因素：重组事件的数目：重组事件越多，最小重组片段越小，定位精度越高**

可推及的其他因素：

* 分级标记的密度：当分子标记数比重组事件多时才能更好的检出重组
* 群体大小：群体越大包含的重组事件越多
* 群体结构：群体隔离与自然选择都会降低重组率
* 群体的类型：不同的群体重组率差别很大，是否有杂合基因型也有影响
* 表型的遗传率和测量误差以及检测方法
* 模型的选择（线性模型/混合模型）
* 位点之间是否存在复杂的互作


## **基因芯片和表达谱分析**

### 芯片实验

全过程

1. 提取RNA
2. 反转录（扩增）
3. 标记
4. 杂交
5. 扫描
6. 获得原始数据



基因芯片实验局限性和优点

优点

* 稳定可靠（RNA-seq测序量高对低表达基因的定量才可靠）
* 积累了大量不可重新获取的数据

局限性

* 只能检测已知或确定性的序列
* 无法检测新发现的、未放置到芯片上的基因
* 有部分探针的信号可能会受到非特异性杂交及个体序列差异的影响


### 芯片实验前处理

步骤

1. 数据过滤
2. 背景纠正
3. 均一化
4. 汇总
5. 补缺失值（imputation）
6. 批次效应


#### 均一化

中值均一化

    分位数均一化 Quantile Normalization

    求行平均数 排序 归位

#### 汇总

得到每个基因的单个强度值

    中值平滑法	减去行中位数，减去列中位数，循环重复直至行列中值均为0，所得为残差矩阵，raw-residual = 拟合矩阵


### 差异表达分析

多重检验假设

## 蛋白质结构和功能预测

### 蛋白质结构

* 一级结构：氨基酸的排列顺序
* 二级结构：主要由氢键维系的结果（α-helix、β-sheet、转角、环、无规则卷）
* 三级结构：二级结构进一步折叠形成的结构域
* 四级结构：多个亚基之间的空间结构

### 二级结构预测

* 每一段相邻的氨基酸残基具有形成一定二级结构的倾向
* 各种二级结构非均匀分布在蛋白质中
* 二级结构预测问题时模式分类问题

#### 预测方法

第一代：统计学方法

1.基于单个氨基酸残基统计分析

根据每种氨基酸出现在各种二级结构中倾向或者频率是不同的，通过统计分析，获得的**每个残基出现于特定二级结构构象的倾向性因子**利用倾向性因子预测蛋白质的二级结构

![1705568602644](image/index/1705568602644.png)

2.基于氨基酸片段的统计分析（GOR）

如通过疏水氨基出现的周期性规律预测蛋白质的二级结构

* 当在一段序列中发现第i，i+3，i+4是疏水氨基酸时，这一片段可以被预测为α-helix
* 埋藏的β-sheet通常由连续的疏水残基组成，一侧暴露的β-sheet通常由亲水-疏水的两残基重复模式

第二代：基于立体化学原则的物理化学方法——Lim法

第三代：神经网络与人工智能

**
    运用了长程信息和蛋白质序列的进化信息**


### 三级结构预测方法

1. ***同源建模法（homology modeling）***
   * 也称为比较建模法，是一种基于知识的蛋白质结构预测方法
   * 根据对蛋白质结构数据库PDB中的蛋白质结构比较分析研究得知，**任何一对蛋白质，只要它们序列的长度达到一定程度，序列相似性超过30%，就可以保证他们具有相似的三维结构**
   * 主要步骤：模版搜寻、序列比对、结构保守区寻找、目标模型搭建、结构优化和评估
2. ***折叠识别法（fold recognition）***
   * 蛋白质结构分类可以包括不同层次（ **折叠类型** 、拓扑结构、家族、超家族、结构域、二级结构、超二级结构）
3. ***从头预测法（ab initio prediction）***
   * 从蛋白质的一级结构出发，根据物理化学、量子化学、量子物理的基本原理，利用各种理论方法计算蛋白质肽链所有可能构象的能量，然后从中找到能量最低的构象，作为蛋白质的天然构象
   * 组成部分
     * 表示蛋白质几何结构的方法
     * 能量函数及其参数，或者一个合理的构象得分函数，以便计算各种构象的能量
     * 构象空间搜索技术：对构象空间进行快速搜索，找到全局最小能量相对应的构象

### **膜蛋白**

* 整合膜蛋白 （跨膜膜蛋白）
* 锚定蛋白
* 外周蛋白

### 糖基化修饰

先决条件：信号肽序列

特征：

* 20-35 AA
* 富含疏水氨基酸片段
* 至少含有一个带正电荷的氨基酸

糖苷键类型：

* O—糖苷键类型：丝氨酸、苏氨酸、羟赖氨酸、羟脯氨酸
* N—糖苷键类型：天冬酰胺、赖氨酸、精氨酸
* 脂糖苷键：天冬氨酸、谷氨酸
* 糖肽键：半胱氨酸

    

训练预测蛋白质亚细胞定位的模型需要标注数据，数据来源于Swiss-prot

训练预测蛋白质三维结构的模型需要标注数据，数据来源于PDB


数据重复抽样方法

permutation test	无放回

bootstrap	有放回，且无法检验分子进化树的准确性

